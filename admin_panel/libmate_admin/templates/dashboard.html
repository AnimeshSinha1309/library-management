{% extends 'base.html' %} {% block title %}Home{% endblock %} {% block content%}

<script>
	window.onload = function () {
		CanvasJS.addColorSet("shades", [
			//colorSet Array
			"#39B2D7",
			"#9414D0",
			"#E11BBF",
			"#E11B74",
			"#ED2121",
		]);
		//converting string into json arr and making tupple to array by replacing
		var dataTwo = JSON.parse(
			"{{ data4 | safe }}"
				.replace(/\(/g, "[")
				.replace(/\)/g, "]")
				.replace(/'/g, '"')
		);
		dps = [];
		flag = 0;
		for (var prop in dataTwo) {
			if (flag == 0) {
				flag = 1;
				continue;
			}
			dps.push({
				label: prop,
				y: dataTwo[prop],
			});
		}
		var chart = new CanvasJS.Chart("chartContainer", {
			exportEnabled: true,
			animationEnabled: true,
			title: {
				text: "Fine Frequency",
				fontFamily: "tahoma",
			},
			axisX: {
				title: "Fine Value (in rupees)",
				gridThickness: 0,
			},
			axisY: {
				title: "No. of People",
				gridThickness: 0,
			},
			legend: {
				cursor: "pointer",
				itemclick: toggleDataSeries,
			},
			data: [
				{
					type: "column",
					fillColor: "rgba(158, 224, 244 ,0.5)",
					showInLegend: false,
					dataPoints: dps,
				},
			],
		});
		chart.render();

		var dataTwo = JSON.parse(
			"{{ data2 | safe }}"
				.replace(/\(/g, "[")
				.replace(/\)/g, "]")
				.replace(/'/g, '"')
		);
		dps = [];
		flag = 0;
		for (var prop in dataTwo) {
			if (flag == 0) {
				flag = 1;
				continue;
			}
			dps.push({
				label: prop,
				y: dataTwo[prop],
			});
		}
		var chart2 = new CanvasJS.Chart("chartContainer2", {
			exportEnabled: true,
			animationEnabled: true,
			title: {
				text: "No. of issues per day of month",
				fontFamily: "tahoma",
			},
			axisX: {
				title: "Days of Months",
				gridThickness: 0,
			},
			axisY: {
				title: "No. of books issued",
				gridThickness: 0,
			},
			legend: {
				cursor: "pointer",
				itemclick: toggleDataSeries,
			},
			data: [
				{
					type: "column",
					fillColor: "rgba(158, 224, 244 ,0.5)",
					showInLegend: false,
					dataPoints: dps,
				},
			],
		});
		chart2.render();

		var dataTwo = JSON.parse(
			"{{ data1 | safe }}"
				.replace(/\(/g, "[")
				.replace(/\)/g, "]")
				.replace(/'/g, '"')
		);
		dps = [];
		for (var prop in dataTwo) {
			dps.push({
				label: prop,
				y: dataTwo[prop],
			});
		}

		var chart3 = new CanvasJS.Chart("chartContainer3", {
			exportEnabled: true,
			animationEnabled: true,
			title: {
				text: "No. of issues per day of week",
				fontFamily: "tahoma",
			},
			// dataPointWidth: 2,
			axisX: {
				title: "Day of Week",
				gridThickness: 0,
			},
			axisY: {
				title: "No. of books issued",
				gridThickness: 0,
			},
			legend: {
				cursor: "pointer",
				itemclick: toggleDataSeries,
			},
			data: [
				{
					type: "column",
					fillColor: "rgba(158, 224, 244 ,0.5)",
					showInLegend: false,
					dataPoints: dps,
				},
			],
		});
		chart3.render();

		var dataTwo = JSON.parse(
			"{{ data3 | safe }}"
				.replace(/\(/g, "[")
				.replace(/\)/g, "]")
				.replace(/'/g, '"')
		);
		dps = [];
		for (var prop in dataTwo) {
			dps.push({
				label: prop,
				y: dataTwo[prop],
			});
		}
		var chart4 = new CanvasJS.Chart("chartContainer4", {
			exportEnabled: true,
			animationEnabled: true,
			title: {
				text: "Return duration Frequency",
				fontFamily: "tahoma",
			},
			axisX: {
				title: "Time in days from issue",
				gridThickness: 0,
			},
			axisY: {
				title: "Books returned",
				gridThickness: 0,
			},
			legend: {
				cursor: "pointer",
				itemclick: toggleDataSeries,
			},
			data: [
				{
					type: "column",
					fillColor: "rgba(158, 224, 244 ,0.5)",
					showInLegend: false,
					dataPoints: dps,
				},
			],
		});
		chart4.render();

		var dataTwo = JSON.parse(
			"{{ data5 | safe }}"
				.replace(/\(/g, "[")
				.replace(/\)/g, "]")
				.replace(/'/g, '"')
		);
		dps = [];
		cnt = 0;
		for (var prop in dataTwo) {
			if (cnt == 0) {
				st = "Returned on Time";
			} else if (cnt == 1) {
				st = "Returned in 8-14 days";
			} else {
				st = "Returned after 14 days";
			}
			cnt++;
			dps.push({
				label: st,
				y: dataTwo[prop],
				legendText: st,
			});
		}
		var chart5 = new CanvasJS.Chart("chartContainer5", {
			colorSet: "shades",
			title: {
				text: "Fine Paid",
				fontFamily: "tahoma",
			},
			legend: {
				cursor: "pointer",
			},
			data: [
				{
					type: "pie",
					indexLabelPlacement: "inside",
					indexLabel: " ",
					startAngle: 30,
					innerRadius: 88,
					showInLegend: true,
					toolTipContent: "<b>{label}:</b> {y} (#percent%)",
					dataPoints: dps,
				},
			],
		});
		chart5.render();

		function toggleDataSeries(e) {
			if (
				typeof e.dataSeries.visible === "undefined" ||
				e.dataSeries.visible
			) {
				e.dataSeries.visible = false;
			} else {
				e.dataSeries.visible = true;
			}
			e.chart.render();
		}
	};
</script>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

<div class="main-panel">
	<div class="content-wrapper">
		<div class="page-header">
			<h3 class="page-title">
				<span class="page-title-icon bg-gradient-primary text-white mr-2">
					<i class="mdi mdi-home"></i>
				</span>
				Dashboard
			</h3>
		</div>

		<div class="row">
			<div class="col-md-4 stretch-card grid-margin">
				<div class="card bg-gradient-danger card-img-holder text-white">
					<div class="card-body">
						<img src="/static/circle.svg" class="card-img-absolute" alt="circle-image" />
						<h4 class="font-weight-normal mb-3">
							Total Books
							<i class="mdi mdi-chart-line mdi-24px float-right"></i>
						</h4>
						<h2 class="mb-5">{{book_cnt}}</h2>
						<!-- <h6 class="card-text">Increased by 60%</h6> -->
					</div>
				</div>
			</div>
			<div class="col-md-4 stretch-card grid-margin">
				<div class="card bg-gradient-info card-img-holder text-white">
					<div class="card-body">
						<img src="/static/circle.svg" class="card-img-absolute" alt="circle-image" />
						<h4 class="font-weight-normal mb-3">
							Total Journals
							<i class="mdi mdi-bookmark-outline mdi-24px float-right"></i>
						</h4>
						<h2 class="mb-5">{{journal_cnt}}</h2>
						<!-- <h6 class="card-text">Decreased by 10%</h6> -->
					</div>
				</div>
			</div>
			<div class="col-md-4 stretch-card grid-margin">
				<div class="card bg-gradient-success card-img-holder text-white">
					<div class="card-body">
						<img src="/static/circle.svg" class="card-img-absolute" alt="circle-image" />
						<h4 class="font-weight-normal mb-3">
							Total Issued Books
							<i class="mdi mdi-diamond mdi-24px float-right"></i>
						</h4>
						<h2 class="mb-5">{{issue_cnt}}</h2>
						<!-- <h6 class="card-text">Increased by 5%</h6> -->
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-7 grid-margin stretch-card">
				<div class="card" style="height: 470px;">
					<div class="card-body">
						<div class="clearfix" id="chartContainer">
							<!-- <img src="/static/plot_issue_day_of_month.png" /> -->
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-5 grid-margin stretch-card">
				<div class="card" style="height: 470px;">
					<div class="card-body">
						<div class="clearfix" id="chartContainer2">
							<!-- <img src="/static/plot_category_counts.png" /> -->
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5 grid-margin stretch-card">
				<div class="card" style="height: 470px;">
					<div class="card-body">
						<div class="clearfix" id="chartContainer5">
							<!-- <img src="/static/plot_fines_pie.png" /> -->
						</div>
					</div>
				</div>
			</div>
			<!-- <div class="col-md-7 grid-margin stretch-card">
				<div class="card" style="height: 470px;">
					<div class="card-body">
						<div class="clearfix" id="chartContainer">
							<img src="/static/plot_category_counts.png" />
						</div>
					</div>
				</div>
			</div> -->
		</div>
		<div class="row">
			<div class="col-md-7 grid-margin stretch-card">
				<div class="card" style="height: 470px;">
					<div class="card-body">
						<div class="clearfix" id="chartContainer3">
							<!-- <img src="/static/plot_issue_day_of_week.png" /> -->
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-5 grid-margin stretch-card">
				<div class="card" style="height: 470px;">
					<div class="card-body">
						<div class="clearfix" id="chartContainer4">
							<!-- <img src="/static/plot_return_duration.png" /> -->
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}